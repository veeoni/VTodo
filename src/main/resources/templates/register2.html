<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>用户注册</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css">
    <link rel='stylesheet prefetch' href='https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/components/icon.min.css'>
    <link rel="stylesheet  prefetch" href="../static/css/me.css" th:href="@{/css/me.css}"/>
</head>
<body>
<div class="m-container-small m-padded-tb-massive" style="max-width: 50em !important;">
    <div class="ui container">
        <br><br><br><br>
        <div class="ui middle aligned center aligned grid">
            <div class="column">
                <h2 class="ui teal image header">
                    <div class="content">
                        用户注册
                    </div>
                </h2>
                <div id="register_form" class="ui large form">
                    <div class="ui left aligned segment">
                        <div class="two fields">
                            <div class="field">
                                <label>昵称</label>
                                <input name="nickname" type="text">
                            </div>
                            <div class="field">
                                <label>用户名</label>
                                <input name="username" type="text">
                            </div>
                        </div>
                        <div class="two fields">
                            <div class="field">
                                <label>密码</label>
                                <input name="password" type="password">
                            </div>
                            <div class="field">
                                <label>确认密码</label>
                                <input name="passwordverify" type="password">
                            </div>
                        </div>
                        <div class="two fields">
                            <div class="field">
                                <label>邮箱</label>
                                <input name="email" type="email">
                            </div>
                        </div>
                        <button id="submit_btn" type="button" onclick="checkForm()" class="ui fluid large teal button" >Register</button>
                    </div>

                    <div class="ui mini error message"></div>
                    <div class="ui mini negative message" th:unless="${#strings.isEmpty(message)}" th:text="${message}">
                        用户名和密码错误
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<!--一定要先jquery，再Semantic！！！！！-->
<script src="https://cdn.jsdelivr.net/npm/jquery@3.2/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.js"></script>
<script src="static/js/sha256.js" th:src="@{/js/sha256.js}"></script>
<script>
    $('#pass_input').bind('keydown', function(event) {
        if (event.keyCode == "13" && this.form.password.value.length>0) {
            //回车执行加密
            $('#pass_input').val(sha256_digest(this.form.password.value));
        }
    });
    $('#username_input').bind('keydown', function(event) {
        if (event.keyCode == "13" && this.form.password.value.length>0) {
            //回车执行加密
            $('#pass_input').val(sha256_digest(this.form.password.value));
        }
    });
    $('#submit_btn').click(function () {
        if(this.form.password.value.length>0) {
            $('#pass_input').val(sha256_digest(this.form.password.value));
        }
        $('#login_form').submit();
        // $('#pass_input').val('');
    });
    $('.ui.form').form({
        fields : {
            username : {
                identifier: 'username',
                rules:[{
                    type:'empty',
                    prompt: '请输入用户名'
                }]
            },
            username : {
                identifier: 'nickname',
                rules:[{
                    type:'empty',
                    prompt: '请输入昵称'
                }]
            },
            password : {
                identifier: 'password',
                rules:[{
                    type   : 'regExp[^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)[a-zA-Z\\d]{8,}$]',
                    prompt : '密码：至少8个字符，至少1个大写字母，1个小写字母和1个数字'
                }]
            },
            passwordverify : {
                identifier: 'passwordverify',
                rules:[{
                    type   : 'match[password]',
                    prompt : '确认密码：两次密码不一致'
                }]
            },
            username : {
                identifier: 'email',
                rules:[{
                    type:'email',
                    prompt: '邮箱:请输入正确的邮箱地址'
                }]
            }
        }
    });
    function checkForm() {
        $('.ui.form').form("validate form");
    }
</script>

</body>
</html>